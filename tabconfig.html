<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="./js/tabconfig.js"> </script>
    <script src="./js/MicrosoftTeams.min.js"> </script>
</head>

<body>
    <h1>Configuration</h1>
    <p>Entrez le code de session : </p>
    <input id="idSessionCode" value="une session" />
    <button onclick="btnPush()">Push</button>
</body>

<script>

    function InitMSTeam() {
        microsoftTeams.app.initialize().then(() => {
            microsoftTeams.pages.config.registerOnSaveHandler((saveEvent) => {

                const tabName = document.getElementById("idTabName").value;
                const sessionCode = document.getElementById("idSessionCode").value;

                microsoftTeams.pages.config.setConfig({
                    suggestedDisplayName: tabName,
                    entityId: "Yellow",
                    contentUrl: "tab.html?Session=" + codeSession,
                    websiteUrl: "https://yellowintegration.azurewebsites.net",
                }).then(() => {
                    saveEvent.notifySuccess();
                });
            });

            microsoftTeams.pages.config.setValidityState(true);
        });
    }

    InitMSTeam()

</script>

</html>