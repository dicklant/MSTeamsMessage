<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="./js/tabconfig.js"> </script>
    <script src="./js/MicrosoftTeams.min.js"> </script>
</head>

<body>
    <h1>Configuration Yellow</h1>
    <p>Titre onglet :</p>
    <input type="text" id="idTabName"></input>
    <p>Code de r√©union :</p>
    <input type="text" id="idSessionCode"></input>
    <button onclick="btnPush()">Push</button>
</body>

<script>

    function InitMSTeam() {

        const url = "https://salmon-coast-0d80f3e10.3.azurestaticapps.net/tab.html?Session=" + document.getElementById("idSessionCode").value;
        console.log("URL: " + url);

        microsoftTeams.app.initialize().then(() => {
            microsoftTeams.pages.config.registerOnSaveHandler((saveEvent) => {

                const tabName = document.getElementById("idTabName").value;
                const sessionCode = document.getElementById("idSessionCode").value;



                microsoftTeams.pages.config.setConfig({
                    suggestedDisplayName: tabName,
                    entityId: "testContext",
                    contentUrl: url ,
                    websiteUrl: "https://salmon-coast-0d80f3e10.3.azurestaticapps.net"
                }).then(() => {
                    saveEvent.notifySuccess();
                });
            });

            microsoftTeams.pages.config.setValidityState(true);
        });
    }

    InitMSTeam()

</script>

</html>